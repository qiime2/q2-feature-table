{% extends "base.html" %}

{% block content %}
  <div class="row">
    <div class="col-lg-6">
      <h3>Sequence Length Statistics</h3>
      <table class="table table-striped" id="stats_table">
        <thead>
          <tr>
            <th>Sequence Count</th>
            <th>Min Length</th>
            <th>Max Length</th>
            <th>Mean Length</th>
            <th>Range</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{ stats.count }}</td>
            <td>{{ stats.min }}</td>
            <td>{{ stats.max }}</td>
            <td>{{ stats.mean | round(2) }}</td>
            <td>{{ stats.range }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="col-lg-6">
      <h3>Seven-Number Summary of Sequence Lengths</h3>
      <table class="table table-striped" id="summary_table">
        <thead>
          <tr>
            <th>Percentile:</th>
            {% for percentile in stats.seven_num_summ_percentiles %}
            <th>{{ percentile | int }}%</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          <tr>
          <td>Length (nts):</td>
          {% for value in stats.seven_num_summ_values %}
            <td>{{ value | round(2) }}</td>
          {% endfor %}
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row">
    <div class="col-lg-12">
      <p>
        To download a .tsv file of these descriptive statistics, click
        <a href="stats.tsv" target="_blank" rel="noopener noreferrer">here</a>.
      </p>
    </div>
  </div>

  <div class="row">
    <div class="col-lg-12">
      <h3>Sequence Table</h3>
      <p>
        To BLAST a sequence against the NCBI nt database, click the
        sequence and then click the <i>View report</i>
        button on the resulting page.
      <p>
        To download a raw FASTA file of your sequences, click
        <a href="sequences.fasta" target="_blank" rel="noopener noreferrer">here</a>.
      </p>
      <p>
        <i>Click on a Column header to sort the table.</i>
      </p>
      <table class="table table-striped table-hover" id="seq_table">
        <thead>
          <tr>
            <th>Feature ID</th>
            <th data-tsorter="numeric">Sequence Length</th>
            <th data-tsorter="link">Sequence</th>
          </tr>
        </thead>
        <tbody>
        {% for sequence in data %}
          <tr>
            <td>{{ sequence.id }}</td>
            <td>{{ sequence.len}}</td>
            <td><samp><a target="_blank" href="{{ sequence.url }}" rel="noopener noreferrer">{{ sequence.seq }}</a></samp></td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  <script src="./js/tsorter.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    function init() {
      var sorter = tsorter.create('seq_table');
    }

    window.onload = init;
  </script>
  <style media="screen">
    #seq_table th.descend:after{
      content: "\25B2";
    }
    #seq_table th.ascend:after{
      content: "\25BC";
    }
  </style>
{% endblock %}
